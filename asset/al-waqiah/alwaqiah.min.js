/*!
 * IlmuAlam Quran Tool â€“ Surah Al-Waqiah
 * (c) 2025 IlmuAlam.com. All rights reserved.
 */
document.addEventListener("DOMContentLoaded",function(){(function(){const e=[],t=56,n=document.getElementById("ilmu-saw-ayah-list"),a=document.getElementById("ilmu-saw-audio-player"),o=document.getElementById("ilmu-saw-play-pause-all"),i=document.getElementById("ilmu-saw-autoplay-toggle"),l=document.getElementById("ilmu-saw-loading"),s=document.querySelector(".ilmu-saw-controls"),d=document.getElementById("ilmu-saw-copy-notification");let r=-1,c=!1,u=new Set(JSON.parse(localStorage.getItem("bookmarked_"+t))||[]);async function y(){try{const t=await fetch("https://api.alquran.cloud/v1/surah/"+56+"/editions/ar.alafasy,ms.basmeih,en.transliteration");if(!t.ok)throw new Error("Network response was not ok");const a=await t.json();l&&(l.style.display="none"),s&&(s.style.display="flex");const o=a.data[0].ayahs,i=a.data[1].ayahs,d=a.data[2].ayahs;for(let t=0;t<o.length;t++)e.push({number:o[t].numberInSurah,arabic:o[t].text,translation:i[t].text,transliteration:d[t]?d[t].text:"",audio:o[t].audio});m()}catch(e){l&&(l.innerHTML='<p style="color:red;">Maaf, gagal memuatkan data Surah Al-Waqiah. Sila cuba lagi nanti.</p>'),console.error("Error fetching Surah Al-Waqiah data:",e)}}function m(){if(!n)return;n.innerHTML="",e.forEach((t,a)=>{const o=document.createElement("div");o.className="ilmu-saw-ayah",o.id="ilmu-saw-ayah-"+a,u.has(a)&&o.classList.add("ilmu-saw-bookmarked");const i=u.has(a)?'<svg fill="#ffc107" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"></path></svg>':'<svg fill="currentColor" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V5h10v13z"></path></svg>';o.innerHTML=`<div class="ilmu-saw-ayah-header">
<span class="ilmu-saw-ayah-number">Al-Waqiah : Ayat ${t.number}</span>
<button class="ilmu-saw-action-button" data-action="play" data-index="${a}" aria-label="Mainkan Ayat ${t.number}">
<svg fill="#249749" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>
</button>
</div>
<p class="ilmu-saw-arabic">${t.arabic}</p>
<p class="ilmu-saw-transliteration">${t.transliteration||""}</p>
<p class="ilmu-saw-translation">${t.translation}</p>
<div class="ilmu-saw-ayah-actions">
<button class="ilmu-saw-action-button" data-action="copy" data-index="${a}">
<svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path></svg>
Copy
</button>
<button class="ilmu-saw-action-button" data-action="share" data-index="${a}">
<svg viewBox="0 0 24 24" fill="currentColor"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 8.11C7.5 7.61 6.79 7.3 6 7.3c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3s3-1.34 3-3-1.34-3-3-3z"></path></svg>
Share
</button>
<button class="ilmu-saw-action-button" data-action="bookmark" data-index="${a}">
${i}
Bookmark
</button>
</div>`,n.appendChild(o)}),n.addEventListener("click",p),o&&o.addEventListener("click",()=>c?h():f(0)),a&&a.addEventListener("ended",()=>{i&&i.checked&&r<e.length-1?f(r+1):h()})}function p(t){const n=t.target.closest(".ilmu-saw-action-button");if(!n)return;const a=n.dataset.action,o=parseInt(n.dataset.index,10),l=e[o];if(!l)return;const s=`Surah Al-Waqiah, Ayat ${l.number}:\n\n${l.arabic}\n\n${l.transliteration||""}\n\nTerjemahan: "${l.translation}"\n\n- Dari ilmualam.com`; "play"===a&&f(o),"copy"===a&&w(s),"share"===a&&g(s),"bookmark"===a&&k(o,n)}function f(n){return n>=e.length||n<0?void h():(r=n,a.src=e[n].audio,void a.play().catch(e=>console.error("Audio error:",e)).then(()=>{c=!0,v()}))}function h(){try{a.pause(),a.currentTime=0}catch(e){}c=!1,r=-1,v()}function v(){o&&(o.textContent=c?"Hentikan Bacaan":"Mula Bacaan"),document.querySelectorAll(".ilmu-saw-ayah").forEach((e,t)=>{const n=e.querySelector('[data-action="play"] svg path');t===r&&c?(e.classList.add("ilmu-saw-playing"),n&&n.setAttribute("d","M6 19h4V5H6v14zm8-14v14h4V5h-4z"),e.scrollIntoView({behavior:"smooth",block:"center"})):(e.classList.remove("ilmu-saw-playing"),n&&n.setAttribute("d","M8 5v14l11-7z"))})}function w(e){navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(e).then(()=>x()).catch(t=>{console.error("Clipboard error:",t),b(e)}):b(e)}function b(e){try{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),x()}catch(e){console.error("Fallback copy failed:",e)}}async function g(e){navigator.share?await navigator.share({title:"Ayat dari Surah Al-Waqiah",text:e,url:window.location.href}).catch(e=>{console.error("Share failed:",e)}):w(e)}function k(e,t){const n=document.getElementById("ilmu-saw-ayah-"+e);u.has(e)?(u.delete(e),n&&n.classList.remove("ilmu-saw-bookmarked"),t.innerHTML='<svg fill="currentColor" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V5h10v13z"></path></svg> Bookmark'):(u.add(e),n&&n.classList.add("ilmu-saw-bookmarked"),t.innerHTML='<svg fill="#ffc107" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"></path></svg> Bookmarked'),localStorage.setItem("bookmarked_"+t,JSON.stringify([...u]))}function x(){d&&(d.style.opacity=1,setTimeout(()=>{d.style.opacity=0},2e3))}y()})()});
